<Window x:Class="UI.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:UI"
        mc:Ignorable="d"
        Title="И то, и то"
        Height="519"
        Width="832">
    <TabControl>
        <TabItem Header="Операции">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="300" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>


                <!-- Левая колонка - операции и список товаров -->
                <Grid Grid.Column="0"
                      Grid.RowSpan="2"
                      Margin="10,10,10,10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="150" />
                    </Grid.RowDefinitions>

                    <!-- Заголовок списка операций -->
                    <Label Content="Операции:"
                           FontWeight="Bold"
                           Margin="0,0,0,5" />

                    <!-- Список операций -->
                    <ListBox x:Name="OperationList"
                             Grid.Row="1"
                             BorderBrush="Gray"
                             BorderThickness="1"
                             SelectionChanged="OperationList_SelectionChanged"
                             SelectedIndex="0"
                             Margin="0,0,0,77">
                        <ListBoxItem Content="Добавить новый товар" />
                        <ListBoxItem Content="Отгрузить товар со склада" />
                        <ListBoxItem Content="Переместить товар между складами" />
                    </ListBox>

                    <!-- Заголовок списка товаров -->
                    <Label Grid.Row="1"
                           Content="Товары на складе:"
                           FontWeight="Bold"
                           Margin="0,197,160,50" />

                    <!-- Список товаров - ОТОБРАЖАЕТ ДАННЫЕ СКЛАДА -->
                    <ListBox x:Name="GoodsList"
                             Grid.Row="1"
                             BorderBrush="Gray"
                             BorderThickness="1"
                             ScrollViewer.VerticalScrollBarVisibility="Auto"
                             Margin="0,229,0,0"
                             Grid.RowSpan="3">
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding}"
                                           Margin="2" />
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                    <ComboBox x:Name="WarehouseList"
                              HorizontalAlignment="Left"
                              Height="26"
                              Margin="120,199,0,0"
                              VerticalAlignment="Top"
                              Width="133"
                              SelectionChanged="WarehouseList_SelectionChanged"
                              Grid.Row="1"
                              FontWeight="Bold"
                              ToolTip="Выберите склад, на котором выполняется добавление или отгрузка">
                        <ComboBoxItem Height="26"
                                      Content="Склад 1"
                                      FontWeight="Bold"
                                      IsSelected="True"/>
                        <ComboBoxItem Height="26"
                                      Content="Склад 2"
                                      FontWeight="Bold" />
                        <ComboBoxItem Height="26"
                                      Content="Склад 3"
                                      FontWeight="Bold" />
                        <ComboBoxItem Height="26"
                                      Content="Склад 4"
                                      FontWeight="Bold" />
                        <ComboBoxItem Height="26"
                                      Content="Склад 5"
                                      FontWeight="Bold" />
                    </ComboBox>
                    

                </Grid>

                <!-- Правая колонка - управление операциями -->
                <StackPanel Grid.Column="1"
                            Grid.Row="0"
                            Margin="10,10,10,0">

                    <StackPanel x:Name="EnterGoodsNameAndQuantity"
                                Visibility="Visible">
                        <Label Content="Введите название товара:"
                           FontWeight="Bold"
                           Margin="0,0,0,0" />

                        <TextBox Name="GoodsName"
                                 Margin="0,0,0,10"
                                 Height="30"
                                 TextChanged="GoodsName_TextChanged"
                                 PreviewTextInput="GoodsName_PreviewTextInput"
                                 DataObject.Pasting="GoodsName_Pasting"
                                 ToolTip="Только буквы (кириллица/латиница) и пробелы. Поле не может быть пустым." />

                        <Label Content="Введите количество товара:"
                               FontWeight="Bold"
                               Margin="0,0,0,0" />

                        <TextBox Name="GoodsQuantity"
                                 Margin="0,0,0,10"
                                 Height="30"
                                 TextChanged="GoodsQuantity_TextChanged"
                                 PreviewTextInput="Digits_PreviewTextInput"
                                 PreviewKeyDown="Digits_PreviewKeyDown"
                                 DataObject.Pasting="Digits_Pasting"
                                 ToolTip="Только целые числа больше 0." />
                    </StackPanel>
                    <!-- Область для работы с 3 операцией -->
                    <Border x:Name="MoveGoods"
                            Grid.Column="1"
                            Margin="0,0,0,10"
                            BorderThickness="1"
                            Grid.RowSpan="2"
                            Visibility="Collapsed"
                            ToolTip="Склад-источник. Должен отличаться от склада-получателя.">
                        <StackPanel Margin="5">
                            <TextBlock Text="Выберите склад из которого перемещаем товар:"
                                       FontWeight="Bold"
                                       Margin="0,0,0,5" />
                            <ComboBox x:Name="WarehouseListMoveFrom"
                                      HorizontalAlignment="Left"
                                      Width="100"
                                      Height="26"
                                      SelectionChanged="WarehouseListMoveFrom_SelectionChanged"
                                      Grid.Row="1"
                                      FontWeight="Bold">
                                <ComboBoxItem Height="26"
                                              Content="Склад 1"
                                              FontWeight="Bold" />
                                <ComboBoxItem Height="26"
                                              Content="Склад 2"
                                              FontWeight="Bold" />
                                <ComboBoxItem Height="26"
                                              Content="Склад 3"
                                              FontWeight="Bold" />
                                <ComboBoxItem Height="26"
                                              Content="Склад 4"
                                              FontWeight="Bold" />
                                <ComboBoxItem Height="26"
                                              Content="Склад 5"
                                              FontWeight="Bold" />
                            </ComboBox>
                            
                            <TextBlock Text="Выберите перемещаемый товар:"
                                       FontWeight="Bold"
                                       Margin="0,0,0,5" />
                            <ComboBox x:Name="GoodsNameToMove"
                                      HorizontalAlignment="Left"
                                      Width="100"
                                      Height="26"
                                      SelectionChanged="GoodsNameToMove_SelectionChanged"
                                      Grid.Row="1"
                                      FontWeight="Bold"
                                      ToolTip="Список доступных товаров на складе-источнике (только с остатком > 0).">
                            </ComboBox>
                            <Label Content="Введите количество перемещаемого товара:"
                                   FontWeight="Bold"
                                   Margin="0,0,0,0" />

                            <TextBox Name="GoodsQuantityToMove"
                                     Margin="0,0,0,10"
                                     Height="30"
                                     TextChanged="GoodsQuantityToMovet_TextChanged"
                                     PreviewTextInput="Digits_PreviewTextInput"
                                     PreviewKeyDown="Digits_PreviewKeyDown"
                                     DataObject.Pasting="Digits_Pasting"
                                     ToolTip="Только целые числа больше 0. Не больше, чем остаток на складе-источнике." />

                            <TextBlock Text="Выберите склад в который перемещаем товар:"
                                       FontWeight="Bold"
                                       Margin="0,0,0,5" />
                            <ComboBox x:Name="WarehouseListMoveTo"
                                      HorizontalAlignment="Left"
                                      Width="100"
                                      Height="26"
                                      SelectionChanged="WarehouseListMoveTo_SelectionChanged"
                                      Grid.Row="1"
                                      FontWeight="Bold"
                                      ToolTip="Склад-получатель. Должен отличаться от склада-источника.">
                                <ComboBoxItem Height="26"
                                              Content="Склад 1"
                                              FontWeight="Bold" />
                                <ComboBoxItem Height="26"
                                              Content="Склад 2"
                                              FontWeight="Bold" />
                                <ComboBoxItem Height="26"
                                              Content="Склад 3"
                                              FontWeight="Bold" />
                                <ComboBoxItem Height="26"
                                              Content="Склад 4"
                                              FontWeight="Bold" />
                                <ComboBoxItem Height="26"
                                              Content="Склад 5"
                                              FontWeight="Bold" />
                            </ComboBox>
                        </StackPanel>
                    </Border>
                    <Button Content="Выполнить"
                            Height="30"
                            Margin="0,0,0,10"
                            Click="Button_Click" />

                    <Button Content="Показать контракт"
                            Height="30"
                            Name="ShowContractButton"
                            Click="ShowContractButton_Click" />
                    <Button Content="Справка"
                            Height="30"
                            Margin="0,8,0,0"
                            Click="HelpButton_Click" />

                    <!-- Индикаторы Pre и Post условий -->
                    <Grid Margin="0,10,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>

                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="auto" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>

                            <Rectangle Grid.Column="0"
                                       Width="15"
                                       Height="15"
                                       Fill="Red"
                                       Name="PreConditionIndicator" />

                            <Label Grid.Column="1"
                                   Content="Pre-условие" />
                        </Grid>

                        <Grid Grid.Column="1">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="auto" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>

                            <Rectangle Grid.Column="0"
                                       Width="15"
                                       Height="15"
                                       Fill="Red"
                                       Name="PostConditionIndicator" />

                            <Label Grid.Column="1"
                                   Content="Post-условие" />
                        </Grid>
                    </Grid>
                </StackPanel>
            </Grid>
        </TabItem>

        <TabItem Header="Конструктор WP">
            <Grid Margin="5">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>

                <!-- Секция постусловия -->
                <GroupBox Grid.Row="0"
                          Header="Цель (Post)"
                          Margin="0,0,0,5">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="10" />
                            <ColumnDefinition Width="2*" />
                        </Grid.ColumnDefinitions>

                        <TextBox x:Name="PostConditionTextBox"
                                 Grid.Column="0"
                                 Text="max &gt; 100"
                                 ToolTip="Введите постусловие (например: max&gt;100, y==x-9)" />

                        <TextBox x:Name="PostConditionHumanTextBox"
                                 Grid.Column="2"
                                 Text="max больше 100"
                                 ToolTip="Человеческое описание постусловия" />
                    </Grid>
                </GroupBox>

                <!-- Секция редактора кода -->
                <GroupBox Grid.Row="1"
                          Header="Редактор кода"
                          Margin="0,5">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>

                        <!-- Панель быстрых действий -->
                        <StackPanel Grid.Row="0"
                                    Orientation="Horizontal"
                                    Margin="0,0,0,5">
                            <Button x:Name="AddAssignmentBtn"
                                    Content="Добавить присваивание"
                                    Click="AddAssignmentBtn_Click"
                                    Margin="0,0,5,0" />
                            <Button x:Name="AddIfBtn"
                                    Content="Добавить условие"
                                    Click="AddIfBtn_Click"
                                    Margin="5,0,5,0" />
                            <Button x:Name="ClearCodeBtn"
                                    Content="Очистить"
                                    Click="ClearCodeBtn_Click"
                                    Margin="5,0,0,0"
                                    Background="LightCoral" />

                            <!-- Пресеты -->
                            <ComboBox x:Name="PresetsComboBox"
                                      SelectionChanged="PresetsComboBox_SelectionChanged"
                                      Margin="20,0,0,0"
                                      Width="150">
                                <ComboBoxItem Content="Выберите пресет" />
                                <ComboBoxItem Content="Max из двух" />
                                <ComboBoxItem Content="Квадратное уравнение" />
                                <ComboBoxItem Content="Последовательность присваиваний" />
                            </ComboBox>
                        </StackPanel>

                        <!-- Редактор кода -->
                        <TextBox x:Name="CodeEditorTextBox"
                                 Grid.Row="1"
                                 AcceptsReturn="True"
                                 TextWrapping="Wrap"
                                 FontFamily="Consolas"
                                 FontSize="12"
                                 VerticalScrollBarVisibility="Auto"
                                 Text="if (x1 &gt;= x2) max := x1; else max := x2;" />

                        <!-- Подсказки по синтаксису -->
                        <TextBlock Grid.Row="2"
                                   Text="Синтаксис: x := выражение; if (условие) { ... } else { ... }"
                                   Foreground="Gray"
                                   FontStyle="Italic"
                                   Margin="0,5,0,0" />
                    </Grid>
                </GroupBox>

                <!-- Кнопка расчета -->
                <Button x:Name="CalculateBtn"
                        Grid.Row="2"
                        Content="Рассчитать WP"
                        Click="CalculateBtn_Click"
                        Background="LightGreen"
                        FontWeight="Bold"
                        Height="30"
                        Margin="0,10" />

                <!-- Результаты -->
                <GroupBox Grid.Row="3"
                          Header="Результаты расчета"
                          Margin="0,5,0,0">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>

                        <!-- Пошаговый трейс -->
                        <GroupBox Grid.Row="0"
                                  Header="Пошаговый расчет">
                            <ListBox x:Name="StepsListBox"
                                     FontFamily="Consolas"
                                     FontSize="11" />
                        </GroupBox>

                        <!-- Итоговое предусловие -->
                        <GroupBox Grid.Row="1"
                                  Header="Итоговое предусловие (WP)"
                                  Margin="0,5,0,0">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="10" />
                                    <ColumnDefinition Width="2*" />
                                </Grid.ColumnDefinitions>

                                <TextBox x:Name="WpResultTextBox"
                                         Grid.Column="0"
                                         IsReadOnly="True"
                                         Background="LightYellow" />

                                <TextBox x:Name="WpHumanResultTextBox"
                                         Grid.Column="2"
                                         IsReadOnly="True"
                                         Background="LightCyan" />
                            </Grid>
                        </GroupBox>

                        <!-- Триада Хоара -->
                        <Button Grid.Row="2"
                                Content="Показать триаду Хоара"
                                Click="ShowHoareTriadBtn_Click"
                                Margin="0,5,0,0"
                                Background="LightBlue" />
                    </Grid>
                </GroupBox>
            </Grid>
        </TabItem>
    </TabControl>
</Window>